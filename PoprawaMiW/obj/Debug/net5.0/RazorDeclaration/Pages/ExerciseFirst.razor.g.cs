// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace PoprawaMiW.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "C:\Users\48510\source\repos\PoprawaMiW\PoprawaMiW\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\48510\source\repos\PoprawaMiW\PoprawaMiW\_Imports.razor"
using System.Net.Http.Json;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\48510\source\repos\PoprawaMiW\PoprawaMiW\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\48510\source\repos\PoprawaMiW\PoprawaMiW\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\48510\source\repos\PoprawaMiW\PoprawaMiW\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Users\48510\source\repos\PoprawaMiW\PoprawaMiW\_Imports.razor"
using Microsoft.AspNetCore.Components.Web.Virtualization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\48510\source\repos\PoprawaMiW\PoprawaMiW\_Imports.razor"
using Microsoft.AspNetCore.Components.WebAssembly.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Users\48510\source\repos\PoprawaMiW\PoprawaMiW\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "C:\Users\48510\source\repos\PoprawaMiW\PoprawaMiW\_Imports.razor"
using PoprawaMiW;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "C:\Users\48510\source\repos\PoprawaMiW\PoprawaMiW\_Imports.razor"
using PoprawaMiW.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 11 "C:\Users\48510\source\repos\PoprawaMiW\PoprawaMiW\_Imports.razor"
using Services;

#line default
#line hidden
#nullable disable
#nullable restore
#line 12 "C:\Users\48510\source\repos\PoprawaMiW\PoprawaMiW\_Imports.razor"
using PoprawaMiW.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 13 "C:\Users\48510\source\repos\PoprawaMiW\PoprawaMiW\_Imports.razor"
using System.ComponentModel.DataAnnotations;

#line default
#line hidden
#nullable disable
    [Microsoft.AspNetCore.Components.RouteAttribute("/exerciseFirst")]
    public partial class ExerciseFirst : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line 163 "C:\Users\48510\source\repos\PoprawaMiW\PoprawaMiW\Pages\ExerciseFirst.razor"
       
    public string UserChoice { get; set; } = "";
    public string ClassificationChoice { get; set; } = "";
    public int DecisionId { get; set; } = 1;
    public NormalizationParameters Parameters { get; set; }

    int numberOfColumns = 0;
    int maxNumberOfColumns = 0;
    string maxK = "";
    string rawData = "";

    List<string> dataset = new List<string>();
    List<FileData> fileDatasWithDecision = new List<FileData>();
    List<NumericalFileData> normalizedFileDatas = new List<NumericalFileData>();

    protected override void OnInitialized()
    {
        Parameters = new NormalizationParameters(0, 1);
    }

    private async Task HandleUserDatasetChoice()
    {
        if (UserChoice == "")
        {
            dataset = null;
        }
        else
        {
            dataset = await dataService.FetchData(UserChoice);

            if (dataset != null)
            {
                var firstLine = dataset[0];
                maxNumberOfColumns = dataset[0].Replace(',', ' ').Split(' ').Length;

                for (int i = 0; i < 3; i++)
                {
                    rawData += $"{dataset[i]} \n";
                }
            }
            else
            {
                dataset = null;
                rawData = "";
                fileDatasWithDecision = null;
                normalizedFileDatas = null;

            }
        }
    }

    private void HandleDecisionIdChoice()
    {
        foreach (var x in dataset)
        {
            var output = x.Replace(',', ' ');
            var fileData = new FileData(output, DecisionId - 1);
            fileDatasWithDecision.Add(fileData);

        }
        numberOfColumns = fileDatasWithDecision.ElementAt(0).Attributes.Count;
    }

    private void HandleNormalization()
    {
        var numericalFileDatas = fileDataService.CreateListOfNumericalFileDatas(fileDatasWithDecision.Take(100).ToList());
        normalizedFileDatas = normalizationService.NormalizeData(numericalFileDatas, Parameters.MaxRange, Parameters.MinRange);
    }

    private void HandleUserClassificationChoice()
    {
        if (ClassificationChoice == "firstChoice")
        {
            maxK = knnService.FindSmallestKForFirstWay(normalizedFileDatas).ToString();
        }
        else if (ClassificationChoice == "secondChoice")
        {
            maxK = knnService.FindSmallestKForSecondWay(normalizedFileDatas).ToString();
        }
    }

    public class NormalizationParameters
    {
        [Required]
        public double MinRange { get; set; }
        [Required]
        public double MaxRange { get; set; }

        public NormalizationParameters(double minRange, double maxRange)
        {
            MinRange = minRange;
            MaxRange = maxRange;
        }
    }

#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IKnnService knnService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private INormalizeService normalizationService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IFileDataService fileDataService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IDisplayDataService displayService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private ILoadDataService dataService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private HttpClient Http { get; set; }
    }
}
#pragma warning restore 1591
